<!DOCTYPE html>
<html>
<head>
<link rel="stylesheet" href="style.css">
</head>
<body>
  <div id="loading">Loading...</div>
  <div id="root"></div>
</body>
<script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
<script async src="https://ga.jspm.io/npm:es-module-shims@1.7.0/dist/es-module-shims.js"></script>
<script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react?dev",
    "react-dom/client": "https://esm.sh/react-dom/client?dev"
  }
}
</script>
<script type="text/babel" data-type="module">
import React, { StrictMode } from 'react';
import { createRoot } from 'react-dom/client';

function Rating({ rate }) {
    if(rate==-1)
      return (<><font size="3">average rating: </font><font size="5">N/A</font></>)
    else
      return (<><font size="3">average rating: </font><font size="8">{rate}</font><font size="4">/10</font></>)
}

function Title({ name }) {
    return (<font size="6">{name}</font>)
}

function Picture({ img }) {
  if(img)
     return (<img src={'img/'+img} className="movieImg" />)
  else
     return (<img src="img/na.png" className="movieImg" />)
}

function Feedback({ cnt }) {
  return (<font size="2">Total feedback: {cnt}</font>)
}

let Item = function MyItem(props) {
  return (
    <div className="itemframe">
      <table>
        <tbody>
        <tr>
          <th><Picture img={props.img} /></th>
          <th><table height="250" width="670">
            <tbody>
            <tr height="80">
              <th align="left" valign="top"><Title name={props.name} /></th>
              <th align="right" valign="top"><Rating rate={props.rate} /></th>
            </tr>
            <tr height="130">
              <th colSpan="2" valign="top" align="left">{props.description}</th>
            </tr>
            <tr>
              <th colSpan="2" align="right"><Feedback cnt={props.cnt} /></th>
            </tr>
            </tbody>
            </table></th>
        </tr>
        </tbody>
      </table>
    </div>
  );
}

const api_url =
	"api/public/movies";

async function getapi(url) {
	
	const response = await fetch(url);
	
	var data = await response.json();
	console.log(data);
	if (response) {
		hideloader();
	}
	show(data);
}

function hideloader() {
	document.getElementById('loading').style.display = 'none';
}

function show(data) {
  const root = createRoot(document.getElementById('root'));
  
   const arr2 = [];
   for (let r of data) {
       arr2.push( React.createElement(Item, {key: r.id, img: r.img,name:r.name,description:r.description,rate:r.rate,cnt:r.cnt}) );
       arr2.push( React.createElement("br",{key:'br'+r.id} ) );
   }

  root.render(React.createElement(React.Fragment, null,  arr2) );

}

getapi(api_url);

</script>

<style>
* {
  box-sizing: border-box;
}

body {
  font-family: sans-serif;
  margin: 20px;
  padding: 0;
}

h1 {
  margin-top: 0;
  font-size: 22px;
}

h2 {
  margin-top: 0;
  font-size: 20px;
}

h3 {
  margin-top: 0;
  font-size: 18px;
}

h4 {
  margin-top: 0;
  font-size: 16px;
}

h5 {
  margin-top: 0;
  font-size: 14px;
}

h6 {
  margin-top: 0;
  font-size: 12px;
}

code {
  font-size: 1.2em;
}

ul {
  padding-left: 20px;
}

img { margin: 0 10px 10px 0; height: 90px; }

</style>
</html>
